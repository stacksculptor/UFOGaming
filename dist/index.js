import{useState as v,useRef as f}from"react";import s from"./e";const i=(o,T)=>o===T,S={};function w(o,T=i){const n=f(S);let e=n.current;return s(()=>{n.current=e}),(n.current===S||!T(o,n.current))&&(e=o),e}export function newRidgeState(o,T){let n=[],e=o;function a(t,r){const u=e;e=t instanceof Function?t(e):t,setTimeout(()=>{n.forEach(p=>p(e)),r&&r(e),T&&T.onSet&&T.onSet(e,u)})}function l(t){s(()=>(n.push(t),()=>{n=n.filter(r=>r!==t)}),[t])}function c(){const[t,r]=v(e);return l(r),[t,a]}function d(t,r=i){const[u]=c();return w(t(u),r)}return{use:c,useSelector:d,useValue:()=>c()[0],get:()=>e,set:a,reset:()=>a(o)}}
