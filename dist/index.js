import*as s from"react";import S from"./e";let i=(r,a)=>r===a,l={};function v(r,a=i){let n=s.useRef(l),e=n.current;return S(()=>{n.current=e}),(n.current===l||!a(r,n.current))&&(e=r),e}export function newRidgeState(r,a){let n=[],e=r;function o(t,T){let c=e;e=t instanceof Function?t(e):t,setTimeout(()=>{n.forEach(f=>f(e)),T&&T(e),a&&a.onSet&&a.onSet(e,c)})}function p(t){S(()=>(n.push(t),()=>{n=n.filter(T=>T!==t)}),[t])}function u(){let[t,T]=s.useState(e);return p(T),[t,o]}function d(t,T=i){const[c]=u();return v(t(c),T)}return{use:u,useSelector:d,useValue:()=>u()[0],get:()=>e,set:o,reset:()=>o(r)}}
