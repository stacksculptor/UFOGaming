import{useState as m,useRef as v,useLayoutEffect as y,useEffect as w}from"react";const s=typeof window!="undefined"||typeof document!="undefined"?y:w,f=(u,n)=>u===n,i={};function C(u,n=f){const r=v(i);let e=r.current;return s(()=>{r.current=e}),(r.current===i||!n(u,r.current))&&(e=u),e}export function newRidgeState(u,n){let r=[],e=u;function T(t,o){const S=e;e=t instanceof Function?t(e):t,setTimeout(()=>{var a;r.forEach(p=>p(e)),o==null||o(e),(a=n==null?void 0:n.onSet)==null||a.call(n,e,S)})}function d(t){s(()=>(r.push(t),()=>{r=r.filter(o=>o!==t)}),[t])}function c(){const[t,o]=m(e);return d(o),[t,T]}function l(t,o=f){const[S]=c();return C(t(S),o)}return{use:c,useSelector:l,useValue:()=>c()[0],get:()=>e,set:T,reset:()=>T(u)}}
